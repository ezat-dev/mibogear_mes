<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="productManage">
    
    
    <!-- LOT 보고서 조회 -->
	<select id="getLotList" parameterType="productManage" resultType="productManage">
	SELECT l.regtime, l.lotno AS lot_no, l.lotno_date, l.pattern, l.fac_no, 
	lt.bcf_up, lt.bcf_chim, lt.bcf_diff, lt.bcf_gang, lt.bcf_quen, lt.bcf_drain, lt.end_time
	FROM tb_lot AS l
	INNER JOIN tb_lot_tracking AS lt
	ON l.lotno = lt.lotno
	WHERE l.fac_no = #{fac_no_save}
	</select>
	
	<!-- LOT 보고서 조회(리포트)-->
	<select id="getLotListReport" parameterType="productManage" resultType="productManage">
	SELECT l.regtime, l.lotno AS lot_no, l.lotno_date, l.pattern, l.fac_no, 
	lt.bcf_up, lt.bcf_chim, lt.bcf_diff, lt.bcf_gang, lt.bcf_quen, lt.bcf_drain 
	FROM tb_lot AS l
	INNER JOIN tb_lot_tracking AS lt
	ON l.lotno = #{lot_no}
	WHERE lt.lotno = #{lot_no}
	</select>
	
	    <!-- 종합생산현황 페이지 lot 조회 -->
	<select id="integrationLotList" parameterType="productManage" resultType="productManage">
	SELECT * FROM tb_lot
	ORDER BY regtime DESC LIMIT 7
	</select>
	
	<!-- 종합생산현황 페이지 온도 조회 -->
    	<select id="integrationGetTemp" parameterType="monitoring" resultType="monitoring">
	SELECT * FROM tb_trend_temp AS tt
LEFT JOIN tb_trend_memo AS tm
ON LEFT(tt.date, 16) = tm.date
ORDER BY tt.date DESC LIMIT 1;
	</select>
</mapper>